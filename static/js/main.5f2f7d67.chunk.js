(this["webpackJsonpfeather-coding-assignment"]=this["webpackJsonpfeather-coding-assignment"]||[]).push([[0],{56:function(e,n,t){},77:function(e,n,t){"use strict";t.r(n);var r=t(2),o=t(1),c=t.n(o),a=t(20),i=t.n(a),u=t(5),s=t(7),d=t(38),l=(t(56),t(19)),p=t(13),b=t(14),f=t(39),j=t.n(f),h="INPUT",m="RADIO",x=[{id:"firstName",type:h,questionText:"What's your first name?",placeholder:"i.e. Jane",validationRegex:"^(?!\\s*$).+"},{id:"address",type:h,questionText:"What's your address?",placeholder:"i.e. Lohm\xfchlenstra\xdfe 65",validationRegex:"^(?!\\s*$).+"},{id:"occupation",type:m,questionText:"What's your occupation?",options:[{value:"EMPLOYED",name:"Employed"},{value:"SELF_EMPLOYED",name:"Self employed"},{value:"STUDENT",name:"Student"}]},{id:"children",type:m,questionText:"Do you have any children?",options:[{value:"yes",name:"Yes"},{value:"no",name:"No",stepsToSkip:1}]},{id:"numberOfChildren",type:h,questionText:"How many children do you have?",placeholder:"Type a number here",validationRegex:"^[1-9]\\d*$",skippable:!0},{id:"email",type:h,questionText:"What's your email?",placeholder:"i.e. jane.doe@feather-insurance.com",validationRegex:"^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$"}];function v(e){return e.type===I().type}var O=Object(b.b)({name:"auth",initialState:{token:null,isLoading:!1,errors:null},reducers:{createUserRequest:function(e,n){e.isLoading=!0,e.errors=null},createUserSuccess:function(e,n){e.isLoading=!1,e.token=n.payload},createUserFailed:function(e,n){e.isLoading=!1,e.errors=n.payload},removeToken:function(e){e.token=null}},extraReducers:function(e){e.addMatcher(v,(function(e){e.errors=null}))}}),g=O.actions,y=g.createUserRequest,w=g.createUserSuccess,k=g.createUserFailed,q=g.removeToken,R=O.reducer,C={questions:x,currentIndex:0,stepsSkipped:0,answers:{firstName:"",address:"",children:"",numberOfChildren:"",occupation:"",email:""},isError:!1};function L(e){return e.type===w("").type}var S=Object(b.b)({name:"questionnaire",initialState:C,reducers:{nextQuestion:function(e){if(e.currentIndex<e.questions.length-1){var n=0,t=e.questions[e.currentIndex];if(t.type===m){var r=e.answers[t.id],o=t.options.find((function(e){return e.value===r}));o&&j()(o,"stepsToSkip")&&(n+=o.stepsToSkip)}e.currentIndex+=1+n,e.stepsSkipped=n}},prevQuestion:function(e){var n=x[e.currentIndex];n.skippable&&(e.answers=Object(p.a)(Object(p.a)({},e.answers),{},Object(l.a)({},n.id,""))),e.currentIndex-e.stepsSkipped>0&&(e.currentIndex-=1+e.stepsSkipped,e.stepsSkipped=0)},changeAnswer:function(e,n){var t=n.payload,r=t.answerId,o=t.answer;e.answers=Object(p.a)(Object(p.a)({},e.answers),{},Object(l.a)({},r,o))},setError:function(e,n){e.isError=n.payload}},extraReducers:function(e){e.addMatcher(L,(function(){return C}))}}),E=S.actions,T=E.nextQuestion,I=E.prevQuestion,z=E.changeAnswer,D=E.setError,U=S.reducer,A=t(6);function F(){var e=Object(A.a)(["\n\twidth: 100%;\n\tborder: ",";\n\tpadding: 5px;\n\tfont-size: 1.2rem;\n"]);return F=function(){return e},e}var K=u.b.input(F(),(function(e){return e.isError?"2px solid ".concat(e.theme.colors.red):"2px solid ".concat(e.theme.colors.grey)}));var N=function(e){var n=e.value,t=e.onChange,o=e.onKeyDown,c=e.isError,a=e.placeholder,i=e.controlRef;return Object(r.jsx)(K,{type:"text",placeholder:a,autoFocus:!0,value:n,onChange:t,isError:c,ref:i,onKeyDown:o})};function M(){var e=Object(A.a)(["\n\tmargin-left: 5px;\n\tfont-size: 1.1rem;\n"]);return M=function(){return e},e}function Q(){var e=Object(A.a)(["\n\tdisplay: flex;\n\talign-items: center;\n\tmargin-bottom: 5px;\n\t&:last-child {\n\t\tmargin-bottom: 0;\n\t}\n"]);return Q=function(){return e},e}var W=u.b.div(Q()),P=u.b.label(M());var $=function(e){var n=e.options,t=e.name,o=e.checkedValue,c=e.onChange,a=e.onKeyDown,i=e.controlRef;return Object(r.jsx)("div",{children:n.map((function(e){return Object(r.jsxs)(W,{children:[Object(r.jsx)("input",{type:"radio",name:t,id:e.value,value:e.value,checked:o===e.value,onChange:c,onKeyDown:a,ref:i}),Object(r.jsx)(P,{htmlFor:e.value,children:e.name})]},e.value)}))})};function B(){var e=Object(A.a)(["\n\tposition: absolute;\n\tmargin-top: 5px;\n\tcolor: ",";\n\tfont-size: 1.2rem;\n"]);return B=function(){return e},e}function J(){var e=Object(A.a)(["\n\tmargin: 0 0 15px;\n\tfont-size: 2rem;\n\tfont-weight: bold;\n"]);return J=function(){return e},e}function Y(){var e=Object(A.a)(["\n\tmin-width: 200px;\n\tmargin-bottom: 35px;\n\n\t@media (min-width: 481px) {\n\t\tmin-width: 400px;\n\t}\n"]);return Y=function(){return e},e}var V=u.b.div(Y()),_=u.b.h1(J()),H=u.b.div(B(),(function(e){return e.theme.colors.red}));var G=function(e){var n=e.question,t=e.controlRef,o=e.nextAction,c=Object(s.c)(),a=Object(s.d)((function(e){return e.questionnaire.answers})),i=Object(s.d)((function(e){return e.questionnaire.isError})),u=function(e){c(D(!1)),c(z({answerId:n.id,answer:n.type===h?e.target.value:e.target.id}))},d=function(e){"Enter"===e.key&&o()};return Object(r.jsxs)(V,{children:[Object(r.jsx)(_,{children:n.questionText}),n.type===h?Object(r.jsx)(N,{value:a[n.id],placeholder:n.placeholder,onChange:u,isError:i,controlRef:t,onKeyDown:d}):Object(r.jsx)($,{name:n.id,checkedValue:a[n.id],options:n.options,onChange:u,onKeyDown:d,controlRef:t}),i&&Object(r.jsx)(r.Fragment,{children:n.type===h?Object(r.jsx)(H,{children:"value is not valid"}):Object(r.jsx)(H,{children:"please select an option"})})]})};function X(){var e=Object(A.a)(["\n\tcolor: ",";\n"]);return X=function(){return e},e}function Z(){var e=Object(A.a)(["\n\tmargin-top: 10px;\n"]);return Z=function(){return e},e}function ee(){var e=Object(A.a)(["\n\tpadding: 0 20px;\n"]);return ee=function(){return e},e}function ne(){var e=Object(A.a)(["\n\tdisplay: flex;\n\talign-items: center;\n\theight: 100vh;\n"]);return ne=function(){return e},e}var te=u.b.div(ne()),re=u.b.main(ee()),oe=u.b.div(Z()),ce=u.b.div(X(),(function(e){return e.theme.colors.red}));function ae(){var e=Object(A.a)(["\n\tborder: 0;\n\tbackground: none;\n\tcursor: pointer;\n\ttext-decoration: underline;\n\tcolor: ",";\n\tfont-size: 1rem;\n"]);return ae=function(){return e},e}var ie=u.b.button(ae(),(function(e){return e.theme.colors.blue}));var ue=function(e){var n=e.children,t=e.onClick;return Object(r.jsx)(ie,{type:"button",onClick:t,children:n})};function se(){var e=Object(A.a)(["\n\theight: 2rem;\n\tborder: none;\n\tbackground-color: ",";\n\tcursor: pointer;\n\tpadding: 4px 15px;\n\tcolor: ",";\n\tfont-size: 1rem;\n\n\t&:hover {\n\t\tbackground-color: ",";\n\t}\n\t&:disabled {\n\t\topacity: 0.3;\n\t}\n"]);return se=function(){return e},e}var de=u.b.button(se(),(function(e){return e.theme.colors.purple}),(function(e){return e.theme.colors.white}),(function(e){return e.theme.colors.purpleLighter}));var le=function(e){var n=e.children,t=e.onClick,o=e.disabled;return Object(r.jsx)(de,{type:"button",onClick:t,disabled:o,children:n})};function pe(){var e=Object(A.a)(["\n\ttext-align: center;\n\tcolor: ",";\n\tfont-size: 1.2rem;\n"]);return pe=function(){return e},e}function be(){var e=Object(A.a)(["\n\tdisplay: flex;\n\tjustify-content: space-between;\n\tmargin-bottom: 10px;\n\tborder: 1px solid ",";\n\tpadding: 15px 20px;\n\t&:last-child {\n\t\tmargin-bottom: 0;\n\t}\n"]);return be=function(){return e},e}function fe(){var e=Object(A.a)(["\n\tmargin-bottom: 10px;\n\tfont-size: 1rem;\n"]);return fe=function(){return e},e}function je(){var e=Object(A.a)(["\n\tmargin: 0 0 10px;\n\tfont-size: 1.5rem;\n\tfont-weight: 500;\n"]);return je=function(){return e},e}function he(){var e=Object(A.a)(["\n\tposition: absolute;\n\ttop: 10px;\n\tleft: 10px;\n"]);return he=function(){return e},e}function me(){var e=Object(A.a)(["\n\tpadding: 0 15px;\n"]);return me=function(){return e},e}function xe(){var e=Object(A.a)(["\n\tfont-size: 2rem;\n"]);return xe=function(){return e},e}function ve(){var e=Object(A.a)(["\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\theight: 100vh;\n"]);return ve=function(){return e},e}var Oe=u.b.div(ve()),ge=u.b.div(xe()),ye=u.b.main(me()),we=u.b.div(he()),ke=u.b.h1(je()),qe=u.b.div(fe()),Re=u.b.div(be(),(function(e){return e.theme.colors.grey})),Ce=u.b.div(pe(),(function(e){return e.theme.colors.red})),Le=t(45);var Se=function(){var e=Object(s.c)(),n=Object(s.d)((function(e){return{questions:e.questionnaire.questions,currentIndex:e.questionnaire.currentIndex,answers:e.questionnaire.answers}}),s.b),t=n.questions,c=n.currentIndex,a=n.answers,i=Object(s.d)((function(e){return{isLoading:e.auth.isLoading,errors:e.auth.errors}}),s.b),u=i.isLoading,d=i.errors,l=Object(o.useRef)(null),b=function(){var n=a[t[c].id],r=!1;if(t[c].type===h){var o=t[c];r=!new RegExp(o.validationRegex).test(n.toString())}else r=!n;e(D(r)),r||e(T()),l.current&&l.current.focus()},f=function(){var n=function(e){e.children;var n=Object(Le.a)(e,["children"]);return Object(p.a)(Object(p.a)({},n),{},{numberOfChildren:parseInt(n.numberOfChildren,10)||0})}(a);e(y(n))};return Object(r.jsx)(te,{children:Object(r.jsxs)(re,{role:"main",children:[Object(r.jsx)(G,{question:t[c],controlRef:l,nextAction:function(){c===t.length-1?f():b()}}),c===t.length-1?Object(r.jsx)(le,{onClick:f,disabled:u,children:"Finish Questionnaire"}):Object(r.jsx)(le,{onClick:b,disabled:u,children:"Next"}),d&&Object(r.jsx)(oe,{children:Object.keys(d).map((function(e){return Object(r.jsxs)(ce,{children:[e,": ",d[e].join(" ")]},e)}))}),c>0&&Object(r.jsx)(we,{children:Object(r.jsx)(ue,{onClick:function(){e(D(!1)),e(I()),l.current&&l.current.focus()},children:"Previous question"})})]})})},Ee=Object(b.b)({name:"recommendation",initialState:{recommendation:[],isLoading:!0,error:null},reducers:{fetchRecommendationRequest:function(e,n){e.isLoading=!0,e.error=null},fetchRecommendationSuccess:function(e,n){e.isLoading=!1,e.recommendation=n.payload},fetchRecommendationFailed:function(e,n){e.isLoading=!1,e.error=n.payload}}}),Te=Ee.actions,Ie=Te.fetchRecommendationRequest,ze=Te.fetchRecommendationSuccess,De=Te.fetchRecommendationFailed,Ue=Ee.reducer;function Ae(e){return(n=e.toLowerCase().replace("_"," ")).charAt(0).toUpperCase()+n.slice(1);var n}var Fe=function(e){var n=e.token,t=Object(s.c)(),c=Object(s.d)((function(e){return{recommendation:e.recommendation.recommendation,isLoading:e.recommendation.isLoading,error:e.recommendation.error}}),s.b),a=c.recommendation,i=c.isLoading,u=c.error;return Object(o.useEffect)((function(){t(Ie(n))}),[n,t]),Object(r.jsx)(Oe,{children:i?Object(r.jsx)(ge,{children:"Loading recommendations..."}):Object(r.jsxs)(ye,{role:"main",children:[Object(r.jsx)(we,{children:Object(r.jsx)(ue,{onClick:function(){t(q())},children:"Take the questionnaire again"})}),Object(r.jsx)(ke,{children:"We got your recommendation"}),Object(r.jsx)(qe,{children:"Based on your answers, this is what make sense for you and what you should pay."}),u?Object(r.jsx)(Ce,{children:u}):a.map((function(e){return Object(r.jsxs)(Re,{children:[Object(r.jsx)("div",{children:Ae(e.type)}),Object(r.jsx)("div",{children:(n=e.price.amount,t=e.price.periodicity,"\u20ac".concat(n," per ").concat(t.toLowerCase()))})]},e.type);var n,t}))]})})};var Ke=function(){var e=Object(s.d)((function(e){return e.auth.token}));return Object(r.jsx)(r.Fragment,{children:e?Object(r.jsx)(Fe,{token:e}):Object(r.jsx)(Se,{})})},Ne=t(16),Me=t(43),Qe=t.n(Me),We=t(44),Pe=t(8),$e=t.n(Pe),Be=t(10),Je=t(24),Ye=t(25),Ve=t.n(Ye),_e="https://challenge-dot-popsure-204813.appspot.com",He={"Content-Type":"application/json"},Ge=function(e){return{headers:Object(p.a)(Object(p.a)({},He),{},{Authorization:"Bearer ".concat(e)})}},Xe={createUser:function(){var e=Object(Je.a)($e.a.mark((function e(n){return $e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ve.a.post("".concat(_e,"/user"),n,{headers:Object(p.a)({},He)}));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),getRecommendation:function(){var e=Object(Je.a)($e.a.mark((function e(n){return $e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ve.a.get("".concat(_e,"/recommendation"),Ge(n)));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},Ze=$e.a.mark(nn),en=$e.a.mark(tn);function nn(e){var n;return $e.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(Be.b)(Xe.createUser,e.payload);case 3:return n=t.sent,t.next=6,Object(Be.d)(w(n.data.jwt));case 6:t.next=17;break;case 8:if(t.prev=8,t.t0=t.catch(0),!t.t0.response||422!==t.t0.response.status){t.next=15;break}return t.next=13,Object(Be.d)(k(t.t0.response.data.errors));case 13:t.next=17;break;case 15:return t.next=17,Object(Be.d)(k({default:["An error occured, please try again later"]}));case 17:case"end":return t.stop()}}),Ze,null,[[0,8]])}function tn(){return $e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Be.e)(y,nn);case 2:case"end":return e.stop()}}),en)}var rn=tn,on=$e.a.mark(an),cn=$e.a.mark(un);function an(e){var n;return $e.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(Be.b)(Xe.getRecommendation,e.payload);case 3:return n=t.sent,t.next=6,Object(Be.d)(ze(n.data));case 6:t.next=17;break;case 8:if(t.prev=8,t.t0=t.catch(0),!t.t0.response||401!==t.t0.response.status){t.next=15;break}return t.next=13,Object(Be.d)(q());case 13:t.next=17;break;case 15:return t.next=17,Object(Be.d)(De("An error occured trying to load your recommendation"));case 17:case"end":return t.stop()}}),on,null,[[0,8]])}function un(){return $e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Be.e)(Ie,an);case 2:case"end":return e.stop()}}),cn)}var sn=un,dn=$e.a.mark(ln);function ln(){return $e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Be.a)([Object(Be.c)(rn),Object(Be.c)(sn)]);case 2:case"end":return e.stop()}}),dn)}var pn=t(9),bn=Object(pn.c)({questionnaire:U,auth:R,recommendation:Ue}),fn={key:"root",version:1,storage:Qe.a,blacklist:["recommendation"]},jn=Object(Ne.g)(fn,bn),hn=Object(We.a)(),mn=Object(b.a)({reducer:jn,middleware:Object(b.c)({serializableCheck:{ignoredActions:[Ne.a,Ne.f,Ne.b,Ne.c,Ne.d,Ne.e]}}).concat(hn)});hn.run(ln);var xn=Object(Ne.h)(mn),vn={colors:{white:"#ffffff",grey:"#bbc8d3",blue:"#0000ee",purple:"#5b4aee",purpleLighter:"#8d81f3",red:"#ed4337"}};i.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(s.a,{store:mn,children:Object(r.jsx)(d.a,{loading:null,persistor:xn,children:Object(r.jsx)(u.a,{theme:vn,children:Object(r.jsx)(Ke,{})})})})}),document.getElementById("root"))}},[[77,1,2]]]);
//# sourceMappingURL=main.5f2f7d67.chunk.js.map